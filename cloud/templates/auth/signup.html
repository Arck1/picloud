{% extends 'main_template.html' %}
{% load static %}

{% block title %}
    Регистрация
{% endblock %}

{% block head %}
    <script src='https://www.google.com/recaptcha/api.js'></script>
{% endblock %}

{% block content %}

    <form method="post" action="{% url 'signup' %}" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="container-fluid no-margin-padding">

            <div class="col-xs-12 col-sm-12 col-md-1 col-lg-2"></div>

            <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4 no-margin-padding">

                <div class="container-fluid sign-form">

                    <div class="form-group">
                        <label for="email" class="col-form-label">Почта<b style="color: crimson">*</b></label>
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
                            <input class="form-control" type="email" value="" name="email" id="email"
                                   placeholder="Введите почту">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="username" class="col-form-label">Логин<b style="color: crimson">*</b></label>
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input class="form-control" type="text" name="username" id="username"
                                   placeholder="Придумайте логин">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="password" class="col-form-label">Пароль<b style="color: crimson">*</b></label>
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
                            <input class="form-control" type="password" name="password" id="password"
                                   placeholder="Введите пароль">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="second_password" class="col-form-label">Повторите пароль<b
                                style="color: crimson">*</b></label>
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-repeat"></i></span>
                            <input class="form-control" type="password" name="second_password" id="second_password"
                                   placeholder="Повторите пароль">
                        </div>
                    </div>

                    <div id="error" class="error">
                        {% if error %} <p>{{ error }}</p> {% endif %}
                    </div>

                    <div class="container-fluid" style="text-align: center; margin-bottom: 10px">
                        <div class="g-recaptcha" style="display: inline-block"
                             data-sitekey="6LcjsksUAAAAAEKIzQNR60uz9k1UiTO6vDEmW86k"></div>
                    </div>

                    <p class="small">
                        Нажимая кнопку «Зарегистрироваться», вы соглашаетесь с&nbsp;<!--
                        --><a href="{% url 'privacy_policy' %}" target="_blank"><!--
                        -->Политикой обработки персональных данных</a>
                        (ссылка откроется в&nbsp;новой вкладке).
                    </p>

                    <div class="form-group">
                        <input class="btn btn-primary col-xs-12" type="submit" value="Зарегистрироваться"/>
                    </div>

                </div>
            </div>

            <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4">
                <div class="alert alert-info alert-dismissible show" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Закрыть">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    Следующие поля НЕ обязательны для заполнения. <br>
                    Вы сможете отредактировать их после регистрации.
                </div>
                <div class="container-fluid sign-form">

                    <div class="form-group">
                        <label for="first-name" class="col-form-label">Имя</label>
                        <input class="form-control" type="text" name="first-name" id="first-name"
                               placeholder="Введите имя" pattern="^[А-Яа-яЁё]{2,20}$"
                               title="(от 3 до 20 символов, без пробелов)">
                    </div>

                    <div class="form-group">
                        <label for="last-name" class="col-form-label">Фамилия</label>
                        <input class="form-control" type="text" name="last-name" id="last-name"
                               placeholder="Введите фамилию" pattern="^[А-Яа-яЁё]{2,20}$"
                               title="(от 3 до 20 символов, без пробелов)">
                    </div>

                    <div class="form-group django-control">
                        <label class="col-form-label">Аватар</label>
                        {{ user_info_form.avatar }}
                    </div>

                </div>

                <div class="container-fluid sign-form">

                    <div class="form-group django-control">
                        <label class="col-form-label">Университет</label>
                        <div class="input-group">
                            <select name="university" id="id_university" class="form-control"></select>
                            <div class="input-group-btn">
                                <a href="{% url 'new_university' %}" class="btn btn-primary ">
                                    <span class="showopacity glyphicon glyphicon-plus"></span>
                                </a>
                            </div>
                        </div>

                    </div>

                    <div class="form-group django-control">
                        <label class="col-form-label">Факультет</label>
                        <div class="input-group">
                            <select name="department" id="id_department"></select>
                            <div class="input-group-btn">
                                <a href="{% url 'new_department' %}" class="btn btn-primary ">
                                    <span class="showopacity glyphicon glyphicon-plus"></span>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="form-group django-control">
                        <label class="col-form-label">Кафедра</label>
                        <div class="input-group">
                            <select name="chair" id="id_chair"></select>
                            <div class="input-group-btn">
                                <a href="{% url 'new_chair' %}" class="btn btn-primary ">
                                    <span class="showopacity glyphicon glyphicon-plus"></span>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="form-group django-control">
                        <label class="col-form-label">Программа обучения</label>
                        <div class="input-group">
                            {{ user_info_form.program }}
                            <div class="input-group-btn">
                                <a href="{% url 'new_program' %}" class="btn btn-primary ">
                                    <span class="showopacity glyphicon glyphicon-plus"></span>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="form-group django-control">
                        <label class="col-form-label">Курс обучения</label>
                            {{ user_info_form.course }}
                    </div>
                </div>

            </div>

            <div class="col-xs-12 col-sm-12 col-md-1 col-lg-2"></div>

        </div>

    </form>

{% endblock %}


{% block js %}

    <script src="{% static 'js/ready.js' %}"></script>
    <script src="{% static "js/department_search.js" %}"></script>

    <script>
        ready(function () {
            clearAndDisableAllLists();
            loadUniversities();

            document.getElementById("id_university").addEventListener("change", () => {
                universityChanged(document.getElementById("id_university").value);
            });
            document.getElementById("id_department").addEventListener("change", () => {
                departmentChanged(document.getElementById("id_department").value);
            });
            document.getElementById("id_chair").addEventListener("change", () => {
                chairChanged(document.getElementById("id_chair").value);
            });
            document.getElementById("id_program").addEventListener("change", () => {
                programChanged(document.getElementById("id_program").value);
            });
        });
    </script>

{% endblock %}
