{% extends 'main_template.html' %}
{% load static %}

{% block title %}
    Cloud
{% endblock %}

{% block cloud_active %}
    class="active"
{% endblock %}

{% block head %}
    <!-- Аутентификация в Яндекс Вебмастер -->
    <meta name="yandex-verification" content="c3f40ad459bc9654"/>
    <!-- Showdown -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.8.6/showdown.min.js"
            integrity="sha256-dwhppIrxD8qC6lNulndZgtIm4XBU9zoMd9OUoXzIDAE=" crossorigin="anonymous"></script>
{% endblock %}

{% block content %}

    <div class="post-list no-margin-padding">
        <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3"></div>
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 no-margin-padding">

        {% autoescape on %}
            {% for post in posts %}
                <div class="post-panel">
                    {% block edit %}
                        <hr>
                    {% endblock %}
                    <h3>
                        <a href="{% url 'post_detail' pk=post.pk %}"> {{ post.title }} </a>
                    </h3>
                    <div class="post-text">
                        <p>{{ post.text }}</p>
                    </div>
                    {% if post.image %}
                        <img src="{{ post.image.url }}" class="post-img">
                    {% endif %}
                    {% if post.link %}
                        <a href="{{ post.link }}">
                            <div class="btn btn-primary full-width">Прикрепленная ссылка</div>
                        </a>
                    {% endif %}
                    {% if post.file %}
                        <a href="{{ post.file.url }}">
                            <div class="btn btn-success full-width">Прикепленный файл</div>
                        </a>
                    {% endif %}
                    <table class="table">
                        <tr>
                            <td>{{ post.author }}</td>
                            <td><a href="/subject/{{ post.subject.pk }}">{{ post.subject.short_title }}</a></td>
                            <td>{{ post.type.title }}</td>
                            <td>{{ post.created_date }}</td>
                            <td><span style="font-size:12px;"
                                      class="showopacity glyphicon glyphicon-eye-open"></span> {{ post.views }}
                            </td>
                        </tr>
                    </table>

                </div>


            {% empty %}
                {% block emptyloop %}
                    <div class="post-panel">
                        <h4>
                            <hr>
                            Здесь будут появляться посты, актуальные для вашего направления.
                            <hr>
                            Но Вы и сами можете внести свой вклад!
                            <hr>
                            <a href="{% url 'post_new' %}">Запостить!</a>
                            <hr>
                        </h4>
                    </div>
                {% endblock %}
            {% endfor %}

        {% endautoescape %}


            {% if posts.has_other_pages %}
                <nav aria-label="Page navigation">
                    <ul class="pagination">

                        {% if posts.has_previous %}
                            <li><a href="?page={{ posts.previous_page_number }}" aria-label="Previous"><span
                                    aria-hidden="true">&laquo;</span></a></li>
                        {% else %}
                            <li class="disabled"><span aria-hidden="true">&laquo;</span></li>
                        {% endif %}

                        {% for i in posts.paginator.page_range %}
                            {% if posts.number == i %}
                                <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
                            {% else %}
                                <li><a href="?page={{ i }}">{{ i }}</a></li>
                            {% endif %}
                        {% endfor %}

                        {% if posts.has_next %}
                            <li><a href="?page={{ posts.next_page_number }}" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
                            </li>
                        {% else %}
                            <li class="disabled"><span aria-hidden="true">&raquo;</span></li>
                        {% endif %}

                    </ul>
                </nav>
            {% endif %}


        </div>
        <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3"></div>
    </div>

{% endblock %}

{% block js %}
    <script src="{% static 'js/toMarkdown.js' %}"></script>
{% endblock %}